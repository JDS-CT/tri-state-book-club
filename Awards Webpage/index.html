<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Book Club Awards Ceremony</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Slab&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div id="backgroundWords" class="background-layer" aria-hidden="true"></div>
<header>
  <h1>Book Club Awards Ceremony</h1>
  <div class="controls">
    <label for="yearSelect">Ceremony Year:</label>
    <select id="yearSelect">
      <option value="2025">2025</option>
      <option value="2024" selected>2024</option>
      <option value="2023">2023</option>
    </select>
  </div>
  <p id="ceremonySubtitle" class="subtitle"></p>
</header>

<nav class="tab-bar" role="tablist" aria-label="Awards navigation">
  <button id="reveal-tab" type="button" class="tab-button active" data-view="reveal" role="tab" aria-selected="true" aria-controls="view-reveal">Awards Reveal</button>
  <button id="nominations-tab" type="button" class="tab-button" data-view="nominations" role="tab" aria-selected="false" aria-controls="view-nominations">Nominations</button>
  <button id="winners-tab" type="button" class="tab-button" data-view="winners" role="tab" aria-selected="false" aria-controls="view-winners">Winners &amp; Finalists</button>
  <button id="data-tab" type="button" class="tab-button" data-view="data" role="tab" aria-selected="false" aria-controls="view-data">Data Exchange</button>
  <button id="diagnostics-tab" type="button" class="tab-button" data-view="diagnostics" role="tab" aria-selected="false" aria-controls="view-diagnostics">Diagnostics</button>
  <button id="voting-tab" type="button" class="tab-button" data-view="voting" role="tab" aria-selected="false" aria-controls="view-voting">Ranked Voting</button>
  <button id="settings-tab" type="button" class="tab-button" data-view="settings" role="tab" aria-selected="false" aria-controls="view-settings">Settings</button>
</nav>

<main>
  <section id="view-reveal" class="view view-active" role="tabpanel" aria-labelledby="reveal-tab">
    <div id="content" class="status-message">Select a year to load awards.</div>
    <button id="revealButton" onclick="revealNext()" disabled>Reveal the Winner</button>
  </section>

  <section id="view-nominations" class="view" role="tabpanel" aria-labelledby="nominations-tab" hidden>
    <div class="view-header">
      <h2>Nominations by Category</h2>
      <p class="view-subtitle">Browse every nominated title for the selected year.</p>
    </div>
    <div id="nominationsContainer" class="panel"></div>
  </section>

  <section id="view-winners" class="view" role="tabpanel" aria-labelledby="winners-tab" hidden>
    <div class="view-header">
      <h2>Winners &amp; Finalists</h2>
      <p class="view-subtitle">Quick reference for ceremony notes and recap emails.</p>
    </div>
    <div id="winnersContainer" class="panel"></div>
  </section>

  <section id="view-data" class="view" role="tabpanel" aria-labelledby="data-tab" hidden>
    <div class="view-header">
      <h2>Ranked Ballot Exchange Format</h2>
      <p class="view-subtitle">Use this schema when importing Google Form results or exporting ballots from the site.</p>
    </div>
    <div class="panel">
      <h3>Sample Exchange Payload</h3>
      <pre id="exchangeSpec" class="code-block" aria-live="polite"></pre>
    </div>
    <div class="panel">
      <h3>Validate an Imported File</h3>
      <p class="view-subtitle">Drop a JSON file produced by Google Forms (after you convert column headers) to confirm it matches the schema.</p>
      <input type="file" id="exchangeFileInput" accept="application/json,.json">
      <div id="exchangeSummary" class="import-summary" aria-live="polite"></div>
    </div>
  </section>

  <section id="view-diagnostics" class="view" role="tabpanel" aria-labelledby="diagnostics-tab" hidden>
    <div class="view-header">
      <h2>Diagnostics Console</h2>
      <p class="view-subtitle">Run targeted checks and copy the output below when reporting issues.</p>
    </div>
    <div id="diagnosticsPanel" class="panel diagnostics-panel" aria-live="polite">
      <div class="diagnostics-actions">
        <button type="button" data-diagnostics-action="reload">Reload Selected Year</button>
        <button type="button" data-diagnostics-action="force-fetch">Force Fetch Only</button>
        <button type="button" data-diagnostics-action="force-xhr">Force XHR Fallback</button>
        <button type="button" data-diagnostics-action="simulate-failure">Simulate Failure</button>
        <button type="button" data-diagnostics-action="show-cache">Show Cached Years</button>
        <button type="button" data-diagnostics-action="copy-log">Copy Log</button>
        <button type="button" data-diagnostics-action="clear-log">Clear Log</button>
      </div>
      <p id="diagnosticsStatus" class="diagnostics-status" data-role="diagnostics-status" aria-live="polite"></p>
      <p class="diagnostics-hint" data-role="diagnostics-copy">Click Copy Log or select the text manually.</p>
      <pre id="diagnosticsOutput" class="code-block diagnostics-output" data-role="diagnostics-output" aria-live="polite">No diagnostics recorded yet.</pre>
    </div>
  </section>

  <section id="view-voting" class="view" role="tabpanel" aria-labelledby="voting-tab" hidden>
    <div class="view-header">
      <h2>Ranked Choice Voting Prototype</h2>
      <p class="view-subtitle">Collect preferences and export them directly into the standard exchange format.</p>
    </div>
    <form id="votingForm" class="panel">
      <fieldset class="voter-info">
        <legend>Voter Details</legend>
        <label for="voterName">Name</label>
        <input id="voterName" name="voterName" type="text" autocomplete="name" placeholder="Alex Reader">
        <label for="voterEmail">Email</label>
        <input id="voterEmail" name="voterEmail" type="email" autocomplete="email" placeholder="alex@example.com">
      </fieldset>
      <div id="votingCategories" class="voting-categories"></div>
      <div class="form-actions">
        <button type="button" id="generateBallot">Generate Ranked Ballot JSON</button>
      </div>
    </form>
    <div class="panel">
      <h3>Generated Ballot</h3>
      <pre id="ballotOutput" class="code-block" aria-live="polite">Select a year and fill out the form to generate a ballot.</pre>
    </div>
  </section>

  <section id="view-settings" class="view" role="tabpanel" aria-labelledby="settings-tab" hidden>
    <div class="view-header">
      <h2>Ceremony Settings</h2>
      <p class="view-subtitle">Customize reveal audio cues for this browser.</p>
    </div>
    <form id="settingsForm" class="panel settings-form">
      <div class="settings-field">
        <label for="revealSoundSelect">Reveal Sound Effect</label>
        <select id="revealSoundSelect" name="revealSound"></select>
        <p class="field-description">Played when nominations burst across the screen.</p>
      </div>
      <div class="settings-field">
        <label for="winnerSoundSelect">Winner Sound Effect</label>
        <select id="winnerSoundSelect" name="winnerSound"></select>
        <p class="field-description">Played when the winner is announced.</p>
      </div>
      <p class="settings-hint">Sound selections are stored locally in this browser.</p>
    </form>
  </section>
</main>

<audio id="explosionSound" src="audio/explosion.mp3"></audio>
<audio id="winnerSound" src="audio/winner_fanfare.mp3"></audio>

<script src="js/awardsLoader.js"></script>
<script src="js/embeddedAwardsData.js"></script>
<script src="js/diagnosticsConsole.js"></script>
<script src="js/votingFormat.js"></script>
<script src="js/backgroundWords.js"></script>
<script src="js/audioCues.js"></script>
<script src="js/settingsManager.js"></script>
<script src="js/script.js"></script>
</body>
</html>
